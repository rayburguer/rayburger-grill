<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verificador de LocalStorage - Ray Burger</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            padding: 20px;
            margin: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: #f97316;
            text-align: center;
            margin-bottom: 30px;
        }

        .status {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #10b981;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .product-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            transition: transform 0.2s;
        }

        .product-card:hover {
            transform: translateY(-5px);
            border-color: #f97316;
        }

        .product-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .product-name {
            font-weight: bold;
            color: #f97316;
            margin-bottom: 5px;
        }

        .product-category {
            font-size: 12px;
            color: #94a3b8;
            margin-bottom: 5px;
        }

        .product-price {
            font-size: 18px;
            color: #10b981;
            font-weight: bold;
        }

        .btn {
            background: #f97316;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin: 10px 5px;
        }

        .btn:hover {
            background: #ea580c;
        }

        .alert {
            background: rgba(239, 68, 68, 0.2);
            border-left: 4px solid #ef4444;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .success {
            background: rgba(16, 185, 129, 0.2);
            border-left: 4px solid #10b981;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üîç Verificador de Productos Guardados</h1>

        <div class="status" id="status">
            <h2>üìä Estado del LocalStorage</h2>
            <p id="statusText">Cargando...</p>
        </div>

        <div>
            <button class="btn" onclick="checkStorage()">üîÑ Recargar Datos</button>
            <button class="btn" onclick="exportData()">üíæ Exportar JSON</button>
            <button class="btn" onclick="clearStorage()">üóëÔ∏è Limpiar Todo</button>
        </div>

        <div class="product-grid" id="productGrid"></div>
    </div>

    <script>
        function checkStorage() {
            const productsData = localStorage.getItem('rayburger_products');
            const statusText = document.getElementById('statusText');
            const productGrid = document.getElementById('productGrid');

            if (!productsData) {
                statusText.innerHTML = '<div class="alert">‚ùå No hay productos guardados en localStorage</div>';
                productGrid.innerHTML = '';
                return;
            }

            try {
                const products = JSON.parse(productsData);

                statusText.innerHTML = `
                    <div class="success">
                        ‚úÖ <strong>${products.length} productos</strong> guardados correctamente<br>
                        üìÖ √öltima actualizaci√≥n: ${new Date().toLocaleString('es-VE')}<br>
                        üíæ Tama√±o: ${(new Blob([productsData]).size / 1024).toFixed(2)} KB
                    </div>
                `;

                // Agrupar por categor√≠a
                const byCategory = {};
                products.forEach(p => {
                    if (!byCategory[p.category]) byCategory[p.category] = [];
                    byCategory[p.category].push(p);
                });

                let html = '';
                Object.keys(byCategory).forEach(category => {
                    html += `<div style="grid-column: 1/-1; margin-top: 20px;"><h3 style="color: #f97316;">üìÅ ${category} (${byCategory[category].length})</h3></div>`;
                    byCategory[category].forEach(product => {
                        html += `
                            <div class="product-card">
                                <img src="${product.image}" alt="${product.name}" class="product-image" onerror="this.src='https://via.placeholder.com/300x150?text=Sin+Imagen'">
                                <div class="product-name">${product.name}</div>
                                <div class="product-category">${product.category}</div>
                                <div class="product-price">$${product.basePrice_usd.toFixed(2)}</div>
                            </div>
                        `;
                    });
                });

                productGrid.innerHTML = html;

            } catch (error) {
                statusText.innerHTML = `<div class="alert">‚ùå Error al leer los datos: ${error.message}</div>`;
                productGrid.innerHTML = '';
            }
        }

        function exportData() {
            const productsData = localStorage.getItem('rayburger_products');
            if (!productsData) {
                alert('No hay datos para exportar');
                return;
            }

            const blob = new Blob([productsData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `rayburger_products_${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
            alert('‚úÖ Datos exportados correctamente');
        }

        function clearStorage() {
            if (confirm('‚ö†Ô∏è ¬øEst√°s seguro de que quieres borrar TODOS los productos guardados?\n\nEsto no se puede deshacer.')) {
                localStorage.removeItem('rayburger_products');
                alert('üóëÔ∏è LocalStorage limpiado');
                checkStorage();
            }
        }

        // Cargar autom√°ticamente al abrir la p√°gina
        checkStorage();

        // Actualizar cada 5 segundos
        setInterval(checkStorage, 5000);
    </script>
</body>

</html>